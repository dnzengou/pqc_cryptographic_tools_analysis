<!DOCTYPE html>
<html lang="en" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cryptographic Techniques Interactive Platform</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/marked/4.0.12/marked.min.js"></script>

    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900&display=swap');
        body { font-family: 'Inter', sans-serif; }

        .nav-link {
            @apply px-3 py-2 rounded-md text-sm font-medium text-stone-300 hover:text-white hover:bg-teal-700 transition-colors;
        }
        .nav-link.active {
            @apply bg-teal-800 text-white;
        }
        .tab-button {
            @apply px-4 py-2 text-lg font-semibold rounded-t-lg border-b-4 border-transparent transition-colors;
        }
        .tab-button.active {
            @apply border-teal-600 text-teal-700;
        }
        #chatbox {
            height: 400px;
            overflow-y: auto;
            border: 1px solid #e2e8f0;
            @apply bg-slate-50 p-4 rounded-lg shadow-inner;
        }
        .message-container {
            @apply mb-3 flex;
        }
        .user-message {
            @apply justify-end;
        }
        .bot-message {
            @apply justify-start;
        }
        .user-bubble {
            background-color: #38bdf8;
            color: white;
            @apply p-3 rounded-xl rounded-tr-none max-w-[75%] shadow;
        }
        .bot-bubble {
            background-color: #115e59;
            color: white;
            @apply p-3 rounded-xl rounded-tl-none max-w-[75%] shadow;
        }
        .analysis-tab-button {
            @apply px-4 py-2 text-base font-medium rounded-t-lg transition-colors border-b-2 border-transparent text-slate-500 hover:text-teal-600;
        }
        .analysis-tab-button.active {
            @apply border-teal-600 text-teal-700 bg-white;
        }
        .markdown-output ul {
            list-style-type: disc;
            padding-left: 1.5rem;
        }
        .markdown-output ol {
            list-style-type: decimal;
            padding-left: 1.5rem;
        }
        .markdown-output h3 {
            @apply text-lg font-semibold mt-4 mb-2;
        }
    </style>
</head>
<body class="bg-stone-50 text-slate-800 font-sans leading-relaxed">

<header class="bg-teal-900 text-white sticky top-0 z-50 shadow-md">
    <nav class="container mx-auto px-4 sm:px-6 lg:px-8">
        <div class="flex items-center justify-between h-16">
            <div class="flex-shrink-0">
                <span class="text-xl font-bold">Crypto Analysis Platform</span>
            </div>
            <div class="hidden md:block">
                <div class="ml-10 flex items-baseline space-x-4">
                    <a href="#comparison" class="nav-link active">Comparison</a>
                    <a href="#encryption" class="nav-link">Encryption</a>
                    <a href="#signatures" class="nav-link">Signatures</a>
                    <a href="#pqc" class="nav-link">PQC</a>
                    <a href="#ai-exploration" class="nav-link">AI Tools</a>
                </div>
            </div>
        </div>
    </nav>
</header>

<main class="container mx-auto px-4 sm:px-6 lg:px-8 py-8 md:py-12">

    <section id="overview" class="my-12">
        <h1 class="text-4xl md:text-5xl font-bold text-teal-800 mb-4 text-center">
            Cryptography's Future: Algorithms and Integrity
        </h1>
        <p class="text-xl text-slate-700 max-w-4xl mx-auto text-center mb-10">
            Explore, compare, and analyze the core pillars of digital security: 
            <strong>Encryption</strong>, <strong>Digital Signatures</strong>, and 
            <strong>Post-Quantum Cryptography (PQC)</strong>. Use our AI tools for deep, 
            context-aware analysis.
        </p>
    </section>

    <hr class="my-16 border-slate-200">

    <!-- Master Comparison Table -->
    <section id="comparison" class="my-12">
        <h2 class="text-3xl font-bold text-center text-slate-800 mb-4">Master Algorithm Comparison</h2>
        <p class="text-lg text-slate-600 max-w-3xl mx-auto text-center mb-8">
            A quick overview of foundational and advanced cryptographic techniques.
        </p>
        <div class="overflow-x-auto bg-white rounded-xl shadow-lg border border-slate-200">
            <table class="min-w-full divide-y divide-slate-200">
                <thead class="bg-teal-50">
                    <tr>
                        <th class="px-6 py-3 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">Algorithm/Scheme</th>
                        <th class="px-6 py-3 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">Primary Function</th>
                        <th class="px-6 py-3 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">Key Type</th>
                        <th class="px-6 py-3 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">Quantum Vulnerability</th>
                        <th class="px-6 py-3 text-left text-xs font-bold text-teal-700 uppercase tracking-wider">Primary Use Case</th>
                    </tr>
                </thead>
                <tbody id="comparisonTableBody" class="divide-y divide-slate-100">
                    <!-- Injected by JS -->
                </tbody>
            </table>
        </div>
    </section>

    <hr class="my-16 border-slate-200">

    <!-- Encryption Section -->
    <section id="encryption" class="my-12 max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-slate-800 mb-4">Symmetric and Asymmetric Encryption</h2>
        <p class="text-lg text-slate-600 text-center mb-8">
            Encryption protects data confidentiality. Compare the two dominant forms.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-blue-500">
                <h3 class="text-2xl font-semibold text-blue-700 mb-4">Symmetric Encryption (e.g., AES)</h3>
                <ul class="list-disc list-inside space-y-2 text-slate-700">
                    <li><strong>One Key:</strong> Same key for encryption/decryption.</li>
                    <li><strong>Speed:</strong> Extremely fast for bulk data.</li>
                    <li><strong>Challenge:</strong> Secure key exchange required.</li>
                    <li><strong>Example:</strong> Hard drive encryption.</li>
                </ul>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-purple-500">
                <h3 class="text-2xl font-semibold text-purple-700 mb-4">Asymmetric Encryption (e.g., RSA, ECC)</h3>
                <ul class="list-disc list-inside space-y-2 text-slate-700">
                    <li><strong>Key Pair:</strong> Public encrypts, private decrypts.</li>
                    <li><strong>Speed:</strong> Slower; used for key exchange.</li>
                    <li><strong>Advantage:</strong> Public key can be shared safely.</li>
                    <li><strong>Example:</strong> TLS handshake.</li>
                </ul>
            </div>
        </div>
    </section>

    <hr class="my-16 border-slate-200">

    <!-- Digital Signatures Section -->
    <section id="signatures" class="my-12 max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-slate-800 mb-4">Digital Signatures: PKI vs. KSI</h2>
        <p class="text-lg text-slate-600 text-center mb-8">
            Signatures ensure integrity and authenticity. The future is keyless.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-2 gap-8">
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-red-500">
                <h3 class="text-2xl font-semibold text-red-700 mb-4">Traditional PKI/X.509 Signatures</h3>
                <ul class="list-disc list-inside space-y-2 text-slate-700">
                    <li><strong>Key Dependency:</strong> Relies on private key secrecy.</li>
                    <li><strong>Validity:</strong> Requires revocation & timestamping.</li>
                    <li><strong>Trust:</strong> Hierarchical CAs.</li>
                    <li><strong>Quantum Risk:</strong> Vulnerable to Shor's algorithm.</li>
                </ul>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-teal-500">
                <h3 class="text-2xl font-semibold text-teal-700 mb-4">Keyless Signature Infrastructure (KSI)</h3>
                <ul class="list-disc list-inside space-y-2 text-slate-700">
                    <li><strong>Keyless:</strong> Uses hash chains + blockchain.</li>
                    <li><strong>Validity:</strong> Indefinite, future-proof.</li>
                    <li><strong>Trust:</strong> Based on hash function security.</li>
                    <li><strong>Quantum:</strong> Inherently resilient.</li>
                </ul>
            </div>
        </div>
    </section>

    <hr class="my-16 border-slate-200">

    <!-- PQC Section -->
    <section id="pqc" class="my-12 max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-slate-800 mb-4">Post-Quantum Cryptography (PQC)</h2>
        <p class="text-lg text-slate-600 text-center mb-8">
            Techniques resistant to quantum attacks. Set to replace RSA/ECC.
        </p>
        <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-orange-500">
                <h3 class="text-xl font-semibold text-orange-700 mb-3">Lattice-Based</h3>
                <p class="text-sm text-slate-600">Security from hard lattice problems. <strong>NIST: CRYSTALS-Kyber.</strong></p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-orange-500">
                <h3 class="text-xl font-semibold text-orange-700 mb-3">Hash-Based</h3>
                <p class="text-sm text-slate-600">Pure hash functions. Stateful. <strong>NIST: XMSS, SPHINCS+.</strong></p>
            </div>
            <div class="bg-white p-6 rounded-xl shadow-lg border-t-4 border-orange-500">
                <h3 class="text-xl font-semibold text-orange-700 mb-3">Code-Based</h3>
                <p class="text-sm text-slate-600">Error-correcting codes. Large keys. <em>McEliece.</em></p>
            </div>
        </div>
    </section>

    <hr class="my-16 border-slate-200">

    <!-- AI Exploration Tools -->
    <section id="ai-exploration" class="my-12 max-w-4xl mx-auto">
        <h2 class="text-3xl font-bold text-center text-slate-800 mb-4">AI-Powered Cryptography Analysis</h2>
        <p class="text-lg text-slate-600 max-w-xl mx-auto text-center mb-8">
            Powered by <strong>Gemma-2B (Open Source)</strong> via Hugging Face.
        </p>

        <div class="bg-white rounded-xl shadow-xl border border-teal-200 overflow-hidden">
            <div class="border-b border-slate-200 flex bg-gray-100">
                <button data-tab="ai-chat" class="analysis-tab-button active">Interactive Chatbot</button>
                <button data-tab="ai-analysis" class="analysis-tab-button">Structured Analysis Tools</button>
            </div>

            <!-- Chatbot Tab -->
            <div id="ai-chat" class="p-4 analysis-pane">
                <div id="chatbox">
                    <div class="message-container bot-message">
                        <div class="bot-bubble">
                            Hello! I'm your Cryptography Analyst. Ask about AES, RSA, KSI, Kyber, or quantum threats.
                        </div>
                    </div>
                </div>
                <div class="p-4 border-t border-slate-200 flex space-x-2">
                    <input type="text" id="chatInput" placeholder="Ask about Dilithium, KSI, or quantum risks..."
                        class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-teal-500 focus:border-teal-500 shadow-sm">
                    <button id="sendMessageButton" class="bg-teal-600 hover:bg-teal-700 text-white font-bold py-3 px-6 rounded-lg transition-colors disabled:bg-teal-300">
                        Send
                    </button>
                </div>
                <div id="chatLoader" class="hidden text-center text-teal-600 font-semibold mt-4">
                    <span class="animate-pulse">Thinking with Gemma-2B...</span>
                </div>
            </div>

            <!-- Analysis Tools Tab -->
            <div id="ai-analysis" class="p-6 analysis-pane hidden">
                <div class="mb-8">
                    <h3 class="text-xl font-bold text-indigo-700 mb-3 flex items-center">
                        <span class="mr-2">Simplify Terminology</span>
                    </h3>
                    <p class="text-gray-600 mb-4 text-sm">Enter a term like "Homomorphic Encryption" for a simple explanation.</p>
                    <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4">
                        <input type="text" id="term-input" placeholder="e.g., Side-Channel Attack"
                            class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-indigo-500 focus:border-indigo-500 shadow-sm">
                        <button id="simplifyButton" class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition disabled:bg-indigo-300">
                            Simplify Term
                        </button>
                    </div>
                </div>

                <div>
                    <h3 class="text-xl font-bold text-green-700 mb-3 flex items-center">
                        <span class="mr-2">Generate Use Cases</span>
                    </h3>
                    <p class="text-gray-600 mb-4 text-sm">Enter an algorithm to get 3 modern real-world applications.</p>
                    <div class="flex flex-col sm:flex-row space-y-3 sm:space-y-0 sm:space-x-4">
                        <input type="text" id="use-case-input" placeholder="e.g., CRYSTALS-Dilithium"
                            class="flex-grow p-3 border border-gray-300 rounded-lg focus:ring-green-500 focus:border-green-500 shadow-sm">
                        <button id="useCaseButton" class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg shadow-md transition disabled:bg-green-300">
                            Find Use Cases
                        </button>
                    </div>
                </div>

                <section id="analysis-result" class="min-h-[120px] bg-gray-100 rounded-xl p-4 flex items-center justify-center text-gray-500 mt-6">
                    Your structured analysis will appear here.
                </section>
            </div>
        </div>
    </section>

</main>

<footer class="bg-teal-900 text-stone-300 text-center p-6 mt-12">
    <p>Cryptographic Techniques Interactive Platform - Powered by <strong>Gemma-2B (Open Source)</strong> via Hugging Face.</p>
</footer>

<script>
    // --- Hugging Face Gemma Configuration ---
    const HF_MODEL = 'google/gemma-2b-it';
    const HF_API_URL = `https://api-inference.huggingface.co/models/${HF_MODEL}`;

    // --- In-Memory Data for Comparison Table ---
    const comparisonData = [
        { algorithm: 'AES-256', function: 'Encryption (Symmetric)', keyType: 'Secret Key (256-bit)', quantum: 'Resilient', useCase: 'Data at Rest, VPN Tunnels' },
        { algorithm: 'RSA', function: 'Encryption/Signatures (Asymmetric)', keyType: 'Public/Private Pair (2048-bit+)', quantum: 'VULNERABLE (Shor\'s)', useCase: 'TLS Handshakes, Digital Certificates' },
        { algorithm: 'Elliptic Curve (ECC)', function: 'Encryption/Signatures (Asymmetric)', keyType: 'Public/Private Pair', quantum: 'VULNERABLE (Shor\'s)', useCase: 'Bitcoin, Mobile Device Security' },
        { algorithm: 'KSI', function: 'Digital Signature/Integrity', keyType: 'Hash-based (Keyless)', quantum: 'RESILIENT', useCase: 'Audit Logs, Supply Chain Integrity' },
        { algorithm: 'CRYSTALS-Kyber', function: 'Key Exchange (PQC)', keyType: 'Lattice-based', quantum: 'Resilient', useCase: 'Post-Quantum TLS' },
        { algorithm: 'CRYSTALS-Dilithium', function: 'Digital Signature (PQC)', keyType: 'Lattice-based', quantum: 'Resilient', useCase: 'Post-Quantum Code Signing' }
    ];

    // --- Chat State ---
    let chatHistory = [];

    const chatSystemPrompt = `You are a world-class cryptographic security consultant and educator. 
Answer questions on AES, RSA, ECC, digital signatures (PKI, KSI), and Post-Quantum Cryptography (Kyber, Dilithium).
Be concise, professional, and use clear language. Limit responses to 2-3 short paragraphs.`;

    // --- Hugging Face API Call ---
    async function callHuggingFaceAPI(userQuery, systemPrompt, useSearch, updateUI) {
        const isAnalysis = updateUI === renderAnalysis;
        const sendButton = isAnalysis
            ? document.getElementById('simplifyButton') || document.getElementById('useCaseButton')
            : document.getElementById('sendMessageButton');
        const loader = isAnalysis ? document.getElementById('analysis-result') : document.getElementById('chatLoader');

        // Loading state
        if (isAnalysis) {
            loader.innerHTML = `<div class="text-center p-4"><svg class="animate-spin h-5 w-5 mr-3 text-blue-500 inline-block" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> Thinking…</div>`;
            document.getElementById('simplifyButton').disabled = true;
            document.getElementById('useCaseButton').disabled = true;
        } else {
            loader.classList.remove('hidden');
            sendButton.disabled = true;
        }

        let prompt = systemPrompt + "\n\n";
        if (isAnalysis) {
            prompt += userQuery;
        } else {
            const recent = chatHistory.slice(-6);
            recent.forEach(msg => {
                const role = msg.role === 'user' ? 'User' : 'Assistant';
                prompt += `${role}: ${msg.parts[0].text}\n`;
            });
            prompt += "Assistant:";
        }

        const payload = {
            inputs: prompt,
            parameters: { max_new_tokens: 256, temperature: 0.7, top_p: 0.9 }
        };

        let retries = 0, maxRetries = 3;
        let data;

        while (retries < maxRetries) {
            try {
                const resp = await fetch(HF_API_URL, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!resp.ok) {
                    const err = await resp.text();
                    if (resp.status === 429 && retries < maxRetries - 1) {
                        const delay = Math.pow(2, retries) * 1000 + Math.random() * 1000;
                        await new Promise(r => setTimeout(r, delay));
                        retries++;
                        continue;
                    }
                    throw new Error(`HF Error ${resp.status}: ${err}`);
                }

                data = await resp.json();
                break;
            } catch (e) {
                console.error(e);
                retries++;
            }
        }

        if (!data || !data[0]?.generated_text) {
            const msg = 'Sorry, no response from AI. Try again.';
            if (isAnalysis) loader.innerHTML = `<p class="text-red-600 p-4">${msg}</p>`;
            else updateUI(msg, false);
        } else {
            const answer = data[0].generated_text.replace(prompt, '').trim();
            updateUI(answer, false);
            if (!isAnalysis) {
                chatHistory.push({ role: "model", parts: [{ text: answer }] });
            }
        }

        // Reset UI
        if (isAnalysis) {
            document.getElementById('simplifyButton').disabled = false;
            document.getElementById('useCaseButton').disabled = false;
        } else {
            sendButton.disabled = false;
            loader.classList.add('hidden');
        }
    }

    // --- Rendering ---
    function renderAnalysis(text) {
        const resultBox = document.getElementById('analysis-result');
        resultBox.innerHTML = `
            <div class="p-6 bg-white border border-gray-200 rounded-lg shadow-inner mt-4 markdown-output">
                <h3 class="text-xl font-semibold text-gray-800 mb-3 border-b pb-2">Analysis Result</h3>
                ${marked.parse(text)}
            </div>`;
        resultBox.scrollIntoView({ behavior: 'smooth' });
    }

    function renderChat(text, isUser) {
        const chatbox = document.getElementById('chatbox');
        const container = document.createElement('div');
        container.className = `message-container ${isUser ? 'user-message' : 'bot-message'}`;
        const bubble = document.createElement('div');
        bubble.className = isUser ? 'user-bubble' : 'bot-bubble';
        bubble.textContent = text;
        container.appendChild(bubble);
        chatbox.appendChild(container);
        chatbox.scrollTop = chatbox.scrollHeight;
    }

    // --- Feature Logic ---
    document.getElementById('simplifyButton').addEventListener('click', async () => {
        const term = document.getElementById('term-input').value.trim();
        if (!term) return renderAnalysis('Please enter a term.');
        const prompt = `You are a technical writer. Simplify this crypto term in one paragraph using an analogy: "${term}"`;
        await callHuggingFaceAPI(prompt, chatSystemPrompt, false, renderAnalysis);
    });

    document.getElementById('useCaseButton').addEventListener('click', async () => {
        const topic = document.getElementById('use-case-input').value.trim();
        if (!topic) return renderAnalysis('Please enter an algorithm.');
        const prompt = `List exactly 3 modern real-world use cases for "${topic}" in a numbered markdown list.`;
        await callHuggingFaceAPI(prompt, chatSystemPrompt, true, renderAnalysis);
    });

    async function sendChatMessage(userMessage) {
        renderChat(userMessage, true);
        chatHistory.push({ role: "user", parts: [{ text: userMessage }] });
        document.getElementById('chatInput').value = '';
        await callHuggingFaceAPI(null, chatSystemPrompt, false, renderChat);
    }

    const chatInput = document.getElementById('chatInput');
    const sendButton = document.getElementById('sendMessageButton');
    sendButton.addEventListener('click', () => {
        const msg = chatInput.value.trim();
        if (msg && !sendButton.disabled) sendChatMessage(msg);
    });
    chatInput.addEventListener('keypress', e => {
        if (e.key === 'Enter' && !sendButton.disabled) {
            const msg = chatInput.value.trim();
            if (msg) sendChatMessage(msg);
        }
    });

    // --- Table Injection ---
    const tableBody = document.getElementById('comparisonTableBody');
    comparisonData.forEach(item => {
        const row = tableBody.insertRow();
        row.className = 'hover:bg-slate-50 transition-colors';
        const vulnClass = item.quantum.includes('VULNERABLE') ? 'text-red-600 font-bold' : 'text-teal-600 font-bold';
        row.innerHTML = `
            <td class="px-6 py-4 whitespace-nowrap text-sm font-medium text-slate-900">${item.algorithm}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">${item.function}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">${item.keyType}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm ${vulnClass}">${item.quantum}</td>
            <td class="px-6 py-4 whitespace-nowrap text-sm text-slate-600">${item.useCase}</td>`;
    });

    // --- Tab Switching ---
    document.querySelectorAll('.analysis-tab-button').forEach(tab => {
        tab.addEventListener('click', () => {
            const tabId = tab.getAttribute('data-tab');
            document.querySelectorAll('.analysis-tab-button').forEach(t => t.classList.remove('active'));
            tab.classList.add('active');
            document.querySelectorAll('.analysis-pane').forEach(pane => {
                pane.classList.toggle('hidden', pane.id !== tabId);
            });
        });
    });

    // --- Navigation ---
    const navLinks = document.querySelectorAll('.nav-link');
    const sections = document.querySelectorAll('section');
    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href') === `#${entry.target.id}`);
                });
            }
        });
    }, { threshold: 0.3 });
    sections.forEach(s => observer.observe(s));

    navLinks.forEach(link => {
        link.addEventListener('click', e => {
            e.preventDefault();
            document.querySelector(link.getAttribute('href')).scrollIntoView({ behavior: 'smooth' });
            navLinks.forEach(l => l.classList.remove('active'));
            link.classList.add('active');
        });
    });
</script>

</body>
</html>
